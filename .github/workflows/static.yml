steps:
  - name: Checkout
    uses: actions/checkout@v4

  - name: Get commit hash
    id: commit
    run: echo "hash=$(git rev-parse --short HEAD)" >> $GITHUB_OUTPUT

  # 1. 특정 커밋 해시 폴더로 스냅샷 배포 (snapshots/8eea7c3)
  - name: Deploy Snapshot
    uses: peaceiris/actions-gh-pages@v4
    with:
      github_token: ${{ secrets.GITHUB_TOKEN }}
      publish_dir: . # 배포할 파일이 있는 디렉토리
      destination_dir: snapshots/${{ steps.commit.outputs.hash }} # 이 경로에 복사됨
      keep_files: true # 중요! 기존의 다른 스냅샷 폴더들을 지우지 않고 유지함

  # 2. 루트 디렉토리에 최신 버전 배포
  - name: Deploy Latest
    uses: peaceiris/actions-gh-pages@v4
    with:
      github_token: ${{ secrets.GITHUB_TOKEN }}
      publish_dir: .
      keep_files: true # snapshots 폴더를 지우지 않기 위해 설정
